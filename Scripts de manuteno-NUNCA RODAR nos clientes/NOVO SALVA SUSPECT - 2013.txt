/****************************************************************************************************
		  ATENÇÃO OEM, EXECUTE CADA PASSO, COM CALMA E INDIVIDUALMENTE, 
		  JAMAIS RODE ESTE SCRIPT TODO JUNTO. 
/****************************************************************************************************

/*PASSO 1 - COLOCAR O BANCO SUSPECT EM READ ONLY 
            SELECIONE ESTE BLOCO E EXECUTE */
USE master 
GO 
sp_configure 'allow updates', 1 
GO 
RECONFIGURE WITH OVERRIDE 
GO 

UPDATE SYSDATABASES SET STATUS=-32768 WHERE NAME='BDRetaguarda' 

/* FIM DO PASSO 1 - FIM DA SELEÇÃO */

/*PASSO 2 - COM O BANCO EM READ ONLY, DAR UM REBUILD NO BANCO E CRIAR EM LOCAL ALTERNATIVO O NOVO LOG USANDO O COMANDO ABAIXO */
sp_resetstatus 'BDRetaguarda'
DBCC Rebuild_log ('BDRetaguarda','C:\BDRetaguarda.ldf')

/*PASSO 3 - VERIFIQUE O ENTERPRISE MANAGER SE O BANCO JA ESTA ATIVO NOVAMENTE, POREM ELE ESTARA COM UMA LEGENDA ENTRE PARENTESES,INDICANDO (DBO USE ONLY), MAS VOCÊ JÁ TEM A POSSIBILIDADE DE FAZER UM BACKUP DOS DADOS.*/
/*PASSO 4 - COM O BACKUP FEITO, EXCLUA O BANCO DE DADOS RECÉM "REBULIDADO" */
/*PASSO 5 - STOP O AGENTE E O SQLSERVER E TODOS OS SEUS SERVIÇOS VIA SYSTRAY E VERIFIQUE SE OS ARQUIVOS FISICOS DO BANCO ESTÃO NA PASTA DA INSTALAÇÃO DOS BD'S /*
/*PASSO 6 - REINICIE O AGENTE E O SQLSERVER E TODOS OS SEUS SERVIÇOS VIA SYSTRAY E CRIE SEGUINDO OS PADRÕES NOVAMENTE O REFERIDO BANCO /*
/*PASSO 7 - RESTAURE O BACKUP QUE VOCÊ SALVOU NO PASSO 3 /*
/*PASSO 8 - CASO O BANCO RECEM RECUPERADO ESTAR COM A LEGENDA ENTRE PARENTESES,INDICANDO (DBO USE ONLY), CLIQUE COM O BOTÃO DIREITO EM CIMA DO MESMO, SELECIONE PROPRIEDADES E VA ATE A GUIA OPTIONS E DESMARQUE
            A OPÇÃO RESTRICT ACESS /*
/*PASSO 9 - PEÇA À ALGUM OPERADOR QUE USE O SISTEMA E AFIRA OS DADOS /*
/*PASSO 10 - EM CASO DE RESPOSTA POSITIVA NO PASSO 9 FINALIZE O SUPORTE /*

